<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Maple's  Blog</title><meta name="author" content="Maple"><meta name="copyright" content="Maple"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="一 切 都 是 最 好 的 安 排 !">
<meta property="og:type" content="website">
<meta property="og:title" content="Maple&#39;s  Blog">
<meta property="og:url" content="https://maple8.github.io/page/2/index.html">
<meta property="og:site_name" content="Maple&#39;s  Blog">
<meta property="og:description" content="一 切 都 是 最 好 的 安 排 !">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://maple8.github.io/img/avatar1.jpeg">
<meta property="article:author" content="Maple">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://maple8.github.io/img/avatar1.jpeg"><link rel="shortcut icon" href="/img/favicon.jpg"><link rel="canonical" href="https://maple8.github.io/page/2/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":22,"languages":{"author":"作者: Maple","link":"链接: ","source":"来源: Maple's  Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Maple\'s  Blog',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-07-03 11:05:30'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/maple_background.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = 'hidden';
    document.getElementById('loading-box').classList.remove("loaded")
  }
}

preloader.initLoading()
window.addEventListener('load',()=> { preloader.endLoading() })

if (false) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar1.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">61</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-blog"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-mug-hot"></i><span> 休闲</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 摄影</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-running"></i><span> 体育</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/yuqiu/"><i class="fa-fw fas fa-volleyball-ball"></i><span> 羽毛球</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 笔者</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background: linear-gradient(to right, #1fa2ff, #12d8fa, #a6ffcb)"><nav id="nav"><span id="blog-info"><a href="/" title="Maple's  Blog"><span class="site-name">Maple's  Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-blog"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-mug-hot"></i><span> 休闲</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 摄影</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-running"></i><span> 体育</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/yuqiu/"><i class="fa-fw fas fa-volleyball-ball"></i><span> 羽毛球</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 笔者</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Maple's  Blog</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://maple8.github.io/" target="_blank" title="Old Version Blog"><i class="fas fa-blog"></i></a><a class="social-icon" href="https://gitee.com/maple_eitba" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:maple_eitba@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=790379323&amp;site=qq&amp;menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2023/12/18/MySQL%E9%9A%90%E5%BC%8F%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/" title="MySQL之隐式类型转换"><img class="post-bg" src="/top_img/table.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL之隐式类型转换"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/12/18/MySQL%E9%9A%90%E5%BC%8F%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/" title="MySQL之隐式类型转换">MySQL之隐式类型转换</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-12-18T09:53:10.000Z" title="发表于 2023-12-18 17:53:10">2023-12-18</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span></div><div class="content">MySQL之隐式类型转换假设查询表tb001所有数据得到结果如下：


那么执行SELECT * FROM TB001 WHERE C1=1.1111会是啥结果呢？

选项1：返回所有记录
选项2：返回id为1的记录
选项3：不返回任何记录
选项4：以上都不对

这似乎是个送分题，必须选2，真的如此么？当表结构定义为：
12345CREATE TABLE `tb001` (`id` int(11) NOT NULL AUTO_INCREMENT,`c1` float DEFAULT NULL,PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8

那么执行结果为：



因为float类型无法进行精确存储，所以无法进行精准的等值查询。

当表结构定义为：
12345CREATE TABLE `tb001` ( `id` int(11) NOT NULL AUTO_INCREMENT, `c1` DECIMAL(18,4) DEFAULT NULL, PRIMARY KEY (`id`) ) ENG ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/12/05/E-R-Model/" title="数据库设计"><img class="post-bg" src="/top_img/er.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库设计"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/12/05/E-R-Model/" title="数据库设计">数据库设计</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-12-05T03:00:27.000Z" title="发表于 2023-12-05 11:00:27">2023-12-05</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/E-R/">E-R</a></span></div><div class="content">数据库设计1 数据库设计概述1.1何为数据库设计？数据库设计是指对于一个给定的应用环境，构造最优的数据库模式，建立数据库及其应用系统，使之能够有效地存储数据，满足各种用户的应用需求（信息要求和处理要求）。
数据库是信息系统的核心和基础，它把信息系统中大量的数据按一定的模型组织起来，并提供存储、维护、检索数据的功能，最终使信息系统可以方便、及时、准确地从数据库中获得所需的信息。即数据库的设计目标是：为用户和各种应用系统提供一个信息基础设施和高效率的运行环境，这里的高效率代表的是冗余少、易维护和便于使用。
数据库设计的全流程


数据库三级模式二级映射

数据库设计大致可分为如下几个阶段：
需求分析 → 概念设计 → 逻辑设计 → 物理设计 → 数据库实施 → 运行与维护阶段

设计数据库核心三个步骤：

把现实世界的实体模型，通过建模转换成信息世界的E-R模型 – 概念结构设计；
信息世界的E-R模型，经过模型转化，得到数据库世界的数据模型 – 逻辑结构设计；
把数据模型进一步规范化，得到最终的数据库结构模型 – 物理结构设计；




数据库世界的数据模型按数据的组织形式而分为三种类型 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/11/07/Maven/" title="Maven"><img class="post-bg" src="/top_img/maven.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Maven"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/11/07/Maven/" title="Maven">Maven</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-11-07T06:16:17.000Z" title="发表于 2023-11-07 14:16:17">2023-11-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%A1%B9%E7%AE%A1%E5%B7%A5%E5%85%B7/">项管工具</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Maven/">Maven</a></span></div><div class="content">MavenMaven 是什么Maven 是一个项目管理工具，它包含了一个项目对象模型（Project Object Model），反映在配置中，就是一个 pom.xml 文件。它是一组标准集合，一个项目的生命周期、一个依赖管理系统，另外还包括定义在项目生命周期阶段的插件(plugin)以及目标(goal)。
当我们使用 Maven 的使用，通过一个自定义的项目对象模型pom.xml 来详细描述我们的项目。
Maven 中的有两大核心：
依赖管理：对 jar 的统一管理(Maven 提供了一个 Maven 的中央仓库mvnrepository.com/ ，当我们添加完对应的依赖Maven就会自动去中央仓库下载相关的依赖，并且解决依赖的依赖问题)。
项目构建：对项目进行编译、测试、打包、部署、上传到私服等。
为什么使用 Maven由于 Java 的生态非常丰富，无论你想实现什么功能，都能找到对应的工具类，这些工具类都是以 jar 包的形式出现的，而jar 包之间会有关联，在使用一个依赖之前，还需要确定这个依赖所依赖的其他依赖，所以，当项目比较大的时候，依赖管理会变得非常麻烦臃肿，这是 Ma ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/10/09/%E6%B5%85%E6%9E%90%E5%A4%9A%E6%BA%90%E5%BC%82%E6%9E%84%E6%95%B0%E6%8D%AE/" title="浅析多源异构数据"><img class="post-bg" src="/top_img/duoyuan.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="浅析多源异构数据"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/10/09/%E6%B5%85%E6%9E%90%E5%A4%9A%E6%BA%90%E5%BC%82%E6%9E%84%E6%95%B0%E6%8D%AE/" title="浅析多源异构数据">浅析多源异构数据</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-10-09T05:55:28.000Z" title="发表于 2023-10-09 13:55:28">2023-10-09</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E5%BC%82%E6%9E%84%E6%95%B0%E6%8D%AE/">异构数据</a></span></div><div class="content">浅析多源异构数据什么是多源异构数据多源：指数据的来源具有多源性。多源异构数据来自多个数据源，包括不同数据库系统和不同设备在工作中采集的数据集。不同的数据源所在的操作系统、管理系统不同（例如OA、CRM、HR、MES、SCM），数据的存储模式和逻辑结构不同，数据的产生时间、使用场所、代码协议等也不同，这造成了数据“多源”的特征。
异构：指数据种类及形态具有复杂性，即异构性。异构数据体现在五个层次上：

计算机体系结构的异构；数据的物理存储来源于不同体系结构的计算机中，如：大型机、小型机、工作站、PC或嵌入式系统中。
操作系统的异构；数据的存储来源于不同的操作系统，如：Unix、Windows、Linux、OS/400等。
数据格式的异构；数据的存储管理机制不同，可以是关系型数据库系统，如：Oracle、SQL Server、DB2等，也可以是文件行二维数据，如：txt、CSV、XLS等。
数据存储地点异构；数据存储在分散的物理位置上，此类情况大多出现在大型机构中，如：销售数据分别存储在北京、上海、日本、韩国等多个分支机构的本地销售系统中。
数据存储的逻辑模型异构；数据分别在不同的业务逻辑 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/08/30/%E8%AE%A2%E5%8D%95%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/" title="订单系统设计"><img class="post-bg" src="/top_img/ordersystem.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="订单系统设计"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/08/30/%E8%AE%A2%E5%8D%95%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/" title="订单系统设计">订单系统设计</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-08-30T08:27:26.000Z" title="发表于 2023-08-30 16:27:26">2023-08-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E4%B8%9A%E5%8A%A1%E6%9E%B6%E6%9E%84/">业务架构</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E8%AE%A2%E5%8D%95%E7%B3%BB%E7%BB%9F/">订单系统</a></span></div><div class="content">订单系统设计todo…
</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/08/24/Squirrel%E7%8A%B6%E6%80%81%E6%9C%BA%EF%BC%88%E5%AE%98%E7%BD%91-%E8%AF%91%EF%BC%89/" title="Squirrel状态机（官网直译版）"><img class="post-bg" src="/top_img/squirrel.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Squirrel状态机（官网直译版）"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/08/24/Squirrel%E7%8A%B6%E6%80%81%E6%9C%BA%EF%BC%88%E5%AE%98%E7%BD%91-%E8%AF%91%EF%BC%89/" title="Squirrel状态机（官网直译版）">Squirrel状态机（官网直译版）</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-08-24T03:39:30.000Z" title="发表于 2023-08-24 11:39:30">2023-08-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E4%B8%9A%E5%8A%A1%E6%9E%B6%E6%9E%84/">业务架构</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E7%8A%B6%E6%80%81%E6%9C%BA/">状态机</a></span></div><div class="content">Squirrel状态机squirrel-foundation为Java提供了一种易于使用、类型安全且高度可扩展的状态机实现。

个人根据官方文档翻译的中文版，官网地址：Squirrel State Machine

squirrel-foundation是什么？就像松鼠这种小巧、敏捷、聪明、警觉和可爱的动物一样，squirrel-foundation旨在为企业提供轻量级、高度灵活和可扩展、可诊断、易于使用和类型安全的Java状态机实现。
下面是描述ATM机状态变化的状态机图:


示例代码可以在“org.squirrelframework.foundation.fsm.atm”包中找到。
MavenSquirrel-foundation已经部署到maven中央存储库，因此您只需要向pom.xml添加以下依赖项。
最新Released版本：
12345&lt;dependency&gt;  &lt;groupId&gt;org.squirrelframework&lt;/groupId&gt;  &lt;artifactId&gt;squirrel-foundation&lt;/arti ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/08/23/%E6%B5%85%E6%9E%90%E6%95%85%E9%9A%9C%E8%BD%AC%E7%A7%BB/" title="浅析故障转移"><img class="post-bg" src="/top_img/failover.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="浅析故障转移"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/08/23/%E6%B5%85%E6%9E%90%E6%95%85%E9%9A%9C%E8%BD%AC%E7%A7%BB/" title="浅析故障转移">浅析故障转移</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-08-23T11:58:47.000Z" title="发表于 2023-08-23 19:58:47">2023-08-23</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E4%B8%9A%E5%8A%A1%E6%9E%B6%E6%9E%84/">业务架构</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E6%95%85%E9%9A%9C%E8%BD%AC%E7%A7%BB/">故障转移</a></span></div><div class="content">浅析故障转移故障转移（failover），即当活动的服务或应用意外终止时，快速启用冗余或备用的服务器、系统、硬件或者网络接替它们工作。 故障转移(failover)与交换转移操作基本相同，只是故障转移通常是自动完成的，没有警告提醒手动完成，而交换转移需要手动进行。
对于要求高可用和高稳定性的服务器、系统或者网络，系统设计者通常会设计故障转移功能。
要使故障转移正常工作，必须有一个数据备份裸机服务器或虚拟机充当恢复站点系统，以便在发生故障时替换主站点。由于故障转移是灾难恢复中必不可少的步骤，因此数据备份系统本身必须不受故障影响。在服务器级别，自动故障转移通常使用一个“心跳”线连接两台服务器。只要主服务器与备用服务器间脉冲或“心跳”没有中断，备用服务器就不会启用。为了热切换和防止服务中断，也可能会有第三台服务器运行备用组件待命。当检测到主服务器“心跳”报警后，备用服务器会接管服务。有些系统有发送故障转移通知的功能。
有些系统故意设计为不能进行完全自动故障转移，而是需要管理员介入。这种“人工确认的自动故障转移”配置，当管理员确认进行故障转移后，整个过程将自动完成。
如何进行故障转移有两种方法 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/08/17/%E7%8A%B6%E6%80%81%E6%9C%BA/" title="状态机业务场景"><img class="post-bg" src="/top_img/fsm.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="状态机业务场景"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/08/17/%E7%8A%B6%E6%80%81%E6%9C%BA/" title="状态机业务场景">状态机业务场景</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-08-17T09:13:03.000Z" title="发表于 2023-08-17 17:13:03">2023-08-17</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E4%B8%9A%E5%8A%A1%E6%9E%B6%E6%9E%84/">业务架构</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E7%8A%B6%E6%80%81%E6%9C%BA/">状态机</a></span></div><div class="content">状态机简介在日常开发中经常遇到运营审核经销商活动、任务等等类似业务需求，大部分需求中状态稳定且单一无需使用状态机，但是也会出现大量的if...else前置状态代码，也是不够那么的“优雅”。随着业务的发展、需求迭代，每一次的业务代码改动都需要维护使用到状态的代码，更让开发人员头疼的是这些维护状态的代码，像散弹一样遍布在各个Service的方法中，不仅增加发布的风险，同时也增加了回归测试的工作量。
什么是状态机？通常所说的状态机为有限状态机（英语：finite-state machine，缩写：FSM），简称状态机， 是表示有限个状态以及在这些状态之间的转移和动作等行为的数学模型。 
应用FSM模型可以帮助对象生命周期的状态的顺序以及导致状态变化的事件进行管理。 将状态和事件控制从不同的业务Service方法的if else中抽离出来。FSM的应用范围很广，状态机 可以描述核心业务规则，核心业务内容。无限状态机，顾名思义状态无限，类似于“π”，暂不做研究。
状态机可归纳为4个要素，即现态、条件、动作、次态。这样的归纳，主要是出于对状态机的内在因果关系的考虑。“现态”和“条件”是因，“动作” ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/08/08/%E6%B3%9B%E5%9E%8B/" title="泛型语法糖"><img class="post-bg" src="/top_img/java.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="泛型语法糖"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/08/08/%E6%B3%9B%E5%9E%8B/" title="泛型语法糖">泛型语法糖</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-08-08T08:33:01.000Z" title="发表于 2023-08-08 16:33:01">2023-08-08</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Java/">Java</a></span></div><div class="content">泛型语法糖什么是泛型
泛型：Java语法糖。
定义：语法糖（Syntactic Sugar），也称糖衣语法。是由英国计算机科学家彼得·约翰·兰达(Peter J. Landin)发明的一个术语，指的是在计算机语言中添加的某种语法，这种语法对语言的编译结果和功能并没有实际影响， 但是却能更方便程序员使用该语言。
作用：通常来说使用语法糖能够减少代码量、增加程序的可读性，从而减少程序代码出错的机会。

泛型是Java SE 1.5的新特性，泛型的本质是参数化类型，也就是说所操作的数据类型被指定为一个参数。这种参数类型可以用在类、接口和方法的创建中，分别称为泛型类、泛型接口、泛型方法。 Java语言引入泛型的好处是安全简单。
泛型有什么好处在Java SE 1.5之前，没有泛型的情况的下，通过对类型Object的引用来实现参数的“任意化”，“任意化”带来的缺点是要做显式的强制类型转换，而这种转换是要求开发者对实际参数类型可以预知的情况下进行的。对于强制类型转换错误的情况，编译器可能不提示错误，在运行的时候才出现异常，这是一个安全隐患。


泛型的好处是在编译的时候检查类型安全，并且所有的强制 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/06/29/%E6%B5%85%E6%9E%90%E5%8A%A0%E5%AF%86%E3%80%81%E7%AD%BE%E5%90%8D%E5%92%8C%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/" title="浅析加密、签名和数字证书"><img class="post-bg" src="/top_img/sign.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="浅析加密、签名和数字证书"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/06/29/%E6%B5%85%E6%9E%90%E5%8A%A0%E5%AF%86%E3%80%81%E7%AD%BE%E5%90%8D%E5%92%8C%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/" title="浅析加密、签名和数字证书">浅析加密、签名和数字证书</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-06-29T11:40:23.000Z" title="发表于 2023-06-29 19:40:23">2023-06-29</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Java/">Java</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E5%8A%A0%E5%AF%86%E3%80%81%E7%AD%BE%E5%90%8D%E3%80%81%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/">加密、签名、数字证书</a></span></div><div class="content">浅析加密、数字签名和数字证书
Q:

非对称加密中公私钥都可以加密，那么什么时候用公钥”加密”，什么时候用私钥“加密” ？
什么是数字签名，数字签名的作用是什么？
为什么要对数据的摘要进行签名，而不是直接计算原始数据的数字签名？
什么是数字证书，数字证书解决了什么问题？


什么是加密加密就是对明文数据按某种特殊算法进行处理，使其成为不可读的一段代码，通常称为“密文”。 密文通过”密钥”解密后还原出原来的明文，通过这样的途径可以达到保护数据不被非法人窃取、阅读的目的。
考虑以下哪些属于加密方法：

AES
DES
RSA
SM4
SHA
MD5
BASE64

这几种都是日常开发中常用的数据编码技术，但是只有 AES、RSA、SM4 才能算是加密算法。
为什么呢？
一个区分的简单方法就是****看编码后的数据是否能还原，能还原的才是加密算法。
MD5 实际上是对数据进行有损压缩，无论数据有多长，1KB、1Mb 还是 1G，都会生成****固定 128 位的散列值（实际开发中会为以32位的十六进制字符串进行显示），并且 MD5 理论上是不可能对编码后的数据进行还原的，即不可逆。MD5 因 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/06/28/%E4%BC%98%E9%9B%85%E5%AF%B9%E6%8E%A5%E7%AC%AC%E4%B8%89%E6%96%B9API/" title="优雅对接第三方API"><img class="post-bg" src="/top_img/api.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="优雅对接第三方API"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/06/28/%E4%BC%98%E9%9B%85%E5%AF%B9%E6%8E%A5%E7%AC%AC%E4%B8%89%E6%96%B9API/" title="优雅对接第三方API">优雅对接第三方API</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-06-28T07:48:07.000Z" title="发表于 2023-06-28 15:48:07">2023-06-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E4%B8%9A%E5%8A%A1%E6%9E%B6%E6%9E%84/">业务架构</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E5%AF%B9%E6%8E%A5%E7%AC%AC%E4%B8%89%E6%96%B9API/">对接第三方API</a></span></div><div class="content">优雅对接第三方API前言在日常的开发中，我们难免会遇见需要和第三方系统进行交互的需求，此时如何设计优雅地对第三方暴露的API就很重要了，不然就可能会出现接口被刷、数据泄露等安全问题。

非技术对接需要注意的点：

与第三方平台对接时，一定要积极和谐友善沟通，要是自己沟通不融洽，对自己的开发进度以及整体团队的对接进度就得往后延期了。

沟通方向要在同个频道，不然可能带来的影响就是：自己写完api文档之后，发给对方之后，发现写得完全就不在方向上，这就很尴尬了。



第三方API对接1. 网络协议方面尽量规范双方使用https协议，因为https是http协议的升级版本，可通过对网络浏览器和网络服务器中间传输的数据进行加密，安全性方面还是比http协议高很多的，从谷歌规范来说，也是使用https协议的。虽然使用成本相对高一些，但这是值得的。
2. 接口请求方面
接口请求类型（GET|POST|PUT|DELETE等等）看具体业务场景规定好；
入参的数据类型要规定好；
数据合法性校验：常规性校验以及业务校验； 
常规性校验：包括签名校验，必填校验，长度校验，类型校验，格式校验等； 
业务校验 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/06/27/Threadlocal/" title="ThreadLocal"><img class="post-bg" src="/top_img/java.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ThreadLocal"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/06/27/Threadlocal/" title="ThreadLocal">ThreadLocal</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-06-27T10:24:55.000Z" title="发表于 2023-06-27 18:24:55">2023-06-27</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Java/">Java</a></span></div><div class="content"></div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/06/27/%E9%92%A9%E5%AD%90%E6%96%B9%E6%B3%95/" title="钩子方法"><img class="post-bg" src="https://img1.baidu.com/it/u=3452134191,3177875868&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=500" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="钩子方法"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/06/27/%E9%92%A9%E5%AD%90%E6%96%B9%E6%B3%95/" title="钩子方法">钩子方法</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-06-27T10:12:05.000Z" title="发表于 2023-06-27 18:12:05">2023-06-27</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Java/">Java</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E9%92%A9%E5%AD%90%E6%96%B9%E6%B3%95/">钩子方法</a></span></div><div class="content">钩子方法
此处的钩子方法和Runtime类中的钩子线程是两种概念：Runtime.getRuntime( ).addShutdownHook( )
请参考：JVM钩子

钩子方法源于设计模式中模板方法（Template Method）模式，模板方法模式的概念为：在一个方法中定义一个算法骨架，而将一些具体步骤延迟到子类中实现。
模板方法使得子类可以在不改变算法结构的情况下，重新定义算法中的某些步骤实现。其方法主要分为两大类：模版方法 和 基本方法，而基本方法又分为：抽象方法（Abstract Method），具体方法（Concrete Method），钩子方法（Hook Method）。
模板方法模式中的四种方法基本定义（前提：在抽象类中定义）：
模板方法​        定义了一个方法，其中定义了整个逻辑的基本骨架。
抽象方法​    由抽象类声明，由具体子类实现，并以abstract关键字进行标识。
具体方法​        由抽象类声明并且实现，子类并不做实现和覆盖操作。其实质就是普遍适用的方法，不需要子类来实现。
钩子方法​        由抽象类声明并且实现，子类也可以选择重写 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/06/26/Lombok/" title="Lombok"><img class="post-bg" src="/top_img/lombok.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Lombok"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/06/26/Lombok/" title="Lombok">Lombok</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-06-26T09:05:21.000Z" title="发表于 2023-06-26 17:05:21">2023-06-26</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Java/">Java</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Lombok/">Lombok</a></span></div><div class="content">1. Lombok简介
官方介绍： Project Lombok is a java library that automatically plugs into your editor and build tools, spicing up your java.Never write another getter or equals method again, with one annotation your class has a fully featured builder, Automate your logging variables, and much more.
官网地址：Project Lombok

意思：Lombok是一个java库，它可以自动插入编辑器和构建工具中，以提升java性能。不需要另外编写getter或equals方法，使用一个注解，你的类就有一个功能齐全的生成器，自动记录变量，等等。
简而言之：Lombok能以简单的注解形式来简化java代码，提高开发人员的效率。
2. Lombok使用使用Lombok需要的开发环境为：Java + Maven + In ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/06/22/%E5%88%86%E9%94%80/" title="分销业务场景"><img class="post-bg" src="https://img.iisp.com/image/20160629/20160629135639_27910.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="分销业务场景"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/06/22/%E5%88%86%E9%94%80/" title="分销业务场景">分销业务场景</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-06-22T03:45:29.000Z" title="发表于 2023-06-22 11:45:29">2023-06-22</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E4%B8%9A%E5%8A%A1%E6%9E%B6%E6%9E%84/">业务架构</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E5%88%86%E9%94%80/">分销</a></span></div><div class="content">分销一、什么是分销在西方经济学中，分销的含义是建立销售渠道的意思。分销渠道又叫营销渠道，是指某种商品或服务从生产者向消费者转移的过程中，获取这种商品或服务的所有权，帮助所有权转移的所有企业和个人。
分销，简单的说，就是让更多的人帮助企业卖货，企业通过裂变分销，实现分销渠道裂变从而达到销售商品的目的。企业为了销售商品，主要的任务是把自己的商品销售出去来获取更多的利润。

传统的销售渠道就是公司招聘销售员，由销售员进行推销产品，另外也会通过互联网进行一些宣传，总而言之一切都是为了把货卖出去。而分销模式是通过分销员向自己身边的朋友以及家人宣传和推广商品并且成交订单，分销员就可以获得一定比例的返佣。


分销的三级代理模式：


二、分销模式的应用分销模式主要是商家在销售商品或服务时，通过其用户的粉丝效应或者朋友交际圈来扩大销售覆盖人群最终实现商品的销售，在电商、保险、信用卡、社区团购较为常见。我们平常在进行商品下单的时候，常需要我们填些推荐码时，或者通过专属的分享链接进行下单，例如我们常见的有淘宝联盟、直播电商平台中主播挂的购物链接等等，这都是属于分销模式。
分销模式最主要的特点为：下级的收 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/06/08/Sentinel7-%E8%A7%84%E5%88%99%E9%85%8D%E7%BD%AE%E6%8C%81%E4%B9%85%E5%8C%96/" title="「Sentinel - 7」-- 规则配置持久化"><img class="post-bg" src="https://img2.baidu.com/it/u=3576658838,828136920&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=PNG?w=500&amp;h=288" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="「Sentinel - 7」-- 规则配置持久化"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/06/08/Sentinel7-%E8%A7%84%E5%88%99%E9%85%8D%E7%BD%AE%E6%8C%81%E4%B9%85%E5%8C%96/" title="「Sentinel - 7」-- 规则配置持久化">「Sentinel - 7」-- 规则配置持久化</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-06-08T14:30:22.000Z" title="发表于 2023-06-08 22:30:22">2023-06-08</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6%E6%A1%86%E6%9E%B6/">流量控制框架</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Sentinel/">Sentinel</a></span></div><div class="content">规则配置持久化规则Sentinel 的理念是开发者只需要关注资源的定义，当资源定义成功后可以动态增加各种流控降级规则。Sentinel 提供两种方式修改规则：

通过 API 直接修改 (loadRules)
通过 DataSource 适配不同数据源修改

通过 API 修改比较直观，可以通过以下几个 API 修改不同的规则：
12FlowRuleManager.loadRules(List&lt;FlowRule&gt; rules); // 修改流控规则DegradeRuleManager.loadRules(List&lt;DegradeRule&gt; rules); // 修改降级规则

手动修改规则（硬编码方式）一般仅用于测试和演示，生产上一般通过动态规则源的方式来动态管理规则。
规则管理模式Sentinel的控制台规则管理有三种模式：Sentinel的规则默认是保存在内存中，Sentinel重启之后规则就会丢失



推送模式
说明
优点
缺点



原始模式
API 将规则推送至客户端并直接更新到内存中，扩展写数据源（WritableDataSource），默认就是这 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/06/07/Sentinel6-%E7%B3%BB%E7%BB%9F%E8%87%AA%E9%80%82%E5%BA%94%E4%BF%9D%E6%8A%A4/" title="「Sentinel - 6」-- 系统自适应保护 &amp; 来源控制"><img class="post-bg" src="https://img2.baidu.com/it/u=3576658838,828136920&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=PNG?w=500&amp;h=288" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="「Sentinel - 6」-- 系统自适应保护 &amp; 来源控制"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/06/07/Sentinel6-%E7%B3%BB%E7%BB%9F%E8%87%AA%E9%80%82%E5%BA%94%E4%BF%9D%E6%8A%A4/" title="「Sentinel - 6」-- 系统自适应保护 &amp; 来源控制">「Sentinel - 6」-- 系统自适应保护 &amp; 来源控制</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-06-07T09:40:33.000Z" title="发表于 2023-06-07 17:40:33">2023-06-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6%E6%A1%86%E6%9E%B6/">流量控制框架</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Sentinel/">Sentinel</a></span></div><div class="content">系统自适应保护Sentinel 系统自适应保护从整体维度对应用入口流量进行控制，结合应用的 Load、总体平均 RT、入口 QPS 和线程数等几个维度的监控指标，让系统的入口流量和系统的负载达到一个平衡，让系统尽可能跑在最大吞吐量的同时保证系统整体的稳定性。
背景在开始之前，先回顾一下 Sentinel 做系统自适应保护的目的：

保证系统不被拖垮
在系统稳定的前提下，保持系统的吞吐量

长期以来，系统自适应保护的思路是根据硬指标，即系统的负载 (load1) 来做系统过载保护。当系统负载高于某个阈值，就禁止或者减少流量的进入；当 load 开始好转，则恢复流量的进入。这个思路给我们带来了不可避免的两个问题：

load 是一个“果”，如果根据 load 的情况来调节流量的通过率，那么就始终有延迟性。也就意味着通过率的任何调整，都会过一段时间才能看到效果。当前通过率是使 load 恶化的一个动作，那么也至少要过 1 秒之后才能观测到；同理，如果当前通过率调整是让 load 好转的一个动作，也需要 1 秒之后才能继续调整，这样就浪费了系统的处理能力。所以我们看到的曲线，总是会有抖动。
恢 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/06/07/Sentinel5-%E7%86%94%E6%96%AD%E9%99%8D%E7%BA%A7/" title="「Sentinel - 5」-- 熔断降级"><img class="post-bg" src="https://img2.baidu.com/it/u=3576658838,828136920&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=PNG?w=500&amp;h=288" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="「Sentinel - 5」-- 熔断降级"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/06/07/Sentinel5-%E7%86%94%E6%96%AD%E9%99%8D%E7%BA%A7/" title="「Sentinel - 5」-- 熔断降级">「Sentinel - 5」-- 熔断降级</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-06-07T09:14:40.000Z" title="发表于 2023-06-07 17:14:40">2023-06-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6%E6%A1%86%E6%9E%B6/">流量控制框架</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Sentinel/">Sentinel</a></span></div><div class="content">熔断降级概述除了流量控制以外，对调用链路中不稳定的资源进行熔断降级也是保障高可用的重要措施之一。一个服务常常会调用别的模块，可能是另外的一个远程服务、数据库，或者第三方 API 等。例如，支付的时候，可能需要远程调用银联提供的 API；查询某个商品的价格，可能需要进行数据库查询。然而，这个被依赖服务的稳定性是不能保证的。如果依赖的服务出现了不稳定的情况，请求的响应时间变长，那么调用服务的方法的响应时间也会变长，线程会产生堆积，最终可能耗尽业务自身的线程池，服务本身也变得不可用。


现代微服务架构都是分布式的，由非常多的服务组成。不同服务之间相互调用，组成复杂的调用链路。以上的问题在链路调用中会产生放大的效果。复杂链路上的某一环不稳定，就可能会层层级联，最终导致整个链路都不可用。因此我们需要对不稳定的弱依赖服务调用进行熔断降级，暂时切断不稳定调用，避免局部不稳定因素导致整体的雪崩。熔断降级作为保护自身的手段，通常在客户端（调用端）进行配置。

注意：本文档针对 Sentinel 1.8.0 及以上版本。1.8.0 版本对熔断降级特性进行了全新的改进升级，请使用最新版本以更好地利用熔断降 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/06/07/Sentinel4-%E7%83%AD%E7%82%B9%E5%8F%82%E6%95%B0%E9%99%90%E6%B5%81/" title="「Sentinel - 4」-- 热点参数限流"><img class="post-bg" src="https://img2.baidu.com/it/u=3576658838,828136920&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=PNG?w=500&amp;h=288" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="「Sentinel - 4」-- 热点参数限流"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/06/07/Sentinel4-%E7%83%AD%E7%82%B9%E5%8F%82%E6%95%B0%E9%99%90%E6%B5%81/" title="「Sentinel - 4」-- 热点参数限流">「Sentinel - 4」-- 热点参数限流</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-06-07T08:12:29.000Z" title="发表于 2023-06-07 16:12:29">2023-06-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6%E6%A1%86%E6%9E%B6/">流量控制框架</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Sentinel/">Sentinel</a></span></div><div class="content">热点参数限流热点参数规则热点参数规则（ParamFlowRule）类似于流量控制规则（FlowRule）：



属性
说明
默认值



resource
资源名，必填



count
限流阈值，必填



grade
限流模式
QPS 模式


durationInSec
统计窗口时间长度（单位为秒），1.6.0 版本开始支持
1s


controlBehavior
流控效果（支持快速失败和匀速排队模式），1.6.0 版本开始支持
快速失败


maxQueueingTimeMs
最大排队等待时长（仅在匀速排队模式生效），1.6.0 版本开始支持
0ms


paramIdx
热点参数的索引，必填，对应 SphU.entry(xxx, args) 中的参数索引位置



paramFlowItemList
参数例外项，可以针对指定的参数值单独设置限流阈值，不受前面 count 阈值的限制。仅支持基本类型和字符串类型



clusterMode
是否是集群参数流控规则
false


clusterConfig
集群流控相关配置



我们可以通过 ParamFlowRuleM ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/06/07/Sentinel3-%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/" title="「Sentinel - 3 」-- 流量控制&amp;规则"><img class="post-bg" src="https://img2.baidu.com/it/u=3576658838,828136920&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=PNG?w=500&amp;h=288" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="「Sentinel - 3 」-- 流量控制&amp;规则"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/06/07/Sentinel3-%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/" title="「Sentinel - 3 」-- 流量控制&amp;规则">「Sentinel - 3 」-- 流量控制&amp;规则</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-06-07T07:42:11.000Z" title="发表于 2023-06-07 15:42:11">2023-06-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6%E6%A1%86%E6%9E%B6/">流量控制框架</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Sentinel/">Sentinel</a></span></div><div class="content">流量控制&amp;规则流量控制规则 (FlowRule)流量规则的定义重要属性：



Field
说明
默认值



resource
资源名，资源名是限流规则的作用对象



count
限流阈值



grade
限流阈值类型，QPS 或线程数模式
QPS 模式


limitApp
流控针对的调用来源
default，代表不区分调用来源


strategy
调用关系限流策略：直接、链路、关联
根据资源本身（直接）


controlBehavior
流控效果（直接拒绝 / 排队等待 / 慢启动模式），不支持按调用关系限流
直接拒绝


同一个资源可以同时有多个限流规则。
通过代码定义流量控制规则理解上面规则的定义之后，我们可以通过调用 FlowRuleManager.loadRules() 方法来用硬编码的方式定义流量控制规则，比如：
1234567891011private static void initFlowQpsRule() &#123;    List&lt;FlowRule&gt; rules = new ArrayList&lt;&gt;();    Flow ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/#content-inner">3</a><a class="page-number" href="/page/4/#content-inner">4</a><a class="extend next" rel="next" href="/page/3/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar1.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Maple</div><div class="author-info__description">一 切 都 是 最 好 的 安 排 !</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">61</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://maple8.github.io/" target="_blank" title="Old Version Blog"><i class="fas fa-blog"></i></a><a class="social-icon" href="https://gitee.com/maple_eitba" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:maple_eitba@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=790379323&amp;site=qq&amp;menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/07/02/%E8%84%B1%E6%95%8F/" title="脱敏"><img src="/top_img/tuomin.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="脱敏"/></a><div class="content"><a class="title" href="/2024/07/02/%E8%84%B1%E6%95%8F/" title="脱敏">脱敏</a><time datetime="2024-07-02T07:15:16.000Z" title="发表于 2024-07-02 15:15:16">2024-07-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/04/%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B-%E4%B8%9A%E5%8A%A1%E6%A8%A1%E5%9E%8B/" title="数据模型-业务模型"><img src="/top_img/model.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据模型-业务模型"/></a><div class="content"><a class="title" href="/2024/06/04/%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B-%E4%B8%9A%E5%8A%A1%E6%A8%A1%E5%9E%8B/" title="数据模型-业务模型">数据模型-业务模型</a><time datetime="2024-06-04T09:54:27.000Z" title="发表于 2024-06-04 17:54:27">2024-06-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/04/%E5%8F%82%E7%85%A7%E6%BA%90List%E5%AF%B9%E7%9B%AE%E6%A0%87List%E8%BF%9B%E8%A1%8C%E6%8E%92%E5%BA%8F/" title="参照源List对目标List进行排序"><img src="/top_img/java.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="参照源List对目标List进行排序"/></a><div class="content"><a class="title" href="/2024/06/04/%E5%8F%82%E7%85%A7%E6%BA%90List%E5%AF%B9%E7%9B%AE%E6%A0%87List%E8%BF%9B%E8%A1%8C%E6%8E%92%E5%BA%8F/" title="参照源List对目标List进行排序">参照源List对目标List进行排序</a><time datetime="2024-06-04T06:14:27.000Z" title="发表于 2024-06-04 14:14:27">2024-06-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/03/Java%E5%85%B3%E9%94%AE%E5%AD%97transient/" title="Java关键字transient"><img src="/top_img/java.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Java关键字transient"/></a><div class="content"><a class="title" href="/2024/06/03/Java%E5%85%B3%E9%94%AE%E5%AD%97transient/" title="Java关键字transient">Java关键字transient</a><time datetime="2024-06-03T03:08:14.000Z" title="发表于 2024-06-03 11:08:14">2024-06-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/05/25/%E6%95%B0%E6%8D%AE%E5%BA%93-%E5%85%B8%E5%9E%8B%E5%9C%BA%E6%99%AF%E8%A1%A8%E8%AE%BE%E8%AE%A1/" title="数据库-典型场景表设计"><img src="/top_img/table.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库-典型场景表设计"/></a><div class="content"><a class="title" href="/2024/05/25/%E6%95%B0%E6%8D%AE%E5%BA%93-%E5%85%B8%E5%9E%8B%E5%9C%BA%E6%99%AF%E8%A1%A8%E8%AE%BE%E8%AE%A1/" title="数据库-典型场景表设计">数据库-典型场景表设计</a><time datetime="2024-05-25T09:09:18.000Z" title="发表于 2024-05-25 17:09:18">2024-05-25</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Git/"><span class="card-category-list-name">Git</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/"><span class="card-category-list-name">Java</span><span class="card-category-list-count">13</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Linux/"><span class="card-category-list-name">Linux</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/OOA-OOD/"><span class="card-category-list-name">OOA&OOD</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Spring/"><span class="card-category-list-name">Spring</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Spring-Cloud/"><span class="card-category-list-name">Spring Cloud</span><span class="card-category-list-count">4</span></a></li>
            </ul></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024 By Maple</div><div class="footer_custom_text">一 切 都 是 最 好 的 安 排 !</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">簡</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('https://cdn.jsdelivr.net/npm/typed.js/dist/typed.umd.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["我原本以为","人生最大的遗憾 是所爱隔山海 山海不可平","后来才发现","海有舟可渡 山有路可行 山海皆可平 难平是人心","没有人不遗憾 只是有人不喊疼","即便是盛世长安三万里 不也处处写尽了遗憾吗","无人不冤 有情皆孽","一切都在变化 且都难随本心","我们能做的是","心有山水不造作 近而不争远是非","且停且忘且随风 且行且看且从容","不念过往 不畏将来"])
  } else {
    document.getElementById("subtitle").innerHTML = '我原本以为'
  }
}
typedJSFn.run(subtitleType)</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>